<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0b0f14" />
  <title>Defuse Bomb</title>
  <style>
    :root{
      --bg:#0b0f14;            /* deep navy */
      --panel:#0f141a;         /* card background */
      --muted:#8aa0b3;         /* secondary text */
      --text:#e8f1ff;          /* primary text */
      --accent:#24d88a;        /* success/neon green */
      --accent-2:#2a92ff;      /* blue accent */
      --danger:#ff5d5d;        /* error red */
      --warning:#ffb020;       /* amber */
      --outline:#1c2733;
      --input:#121922;
      --shadow: 0 8px 30px rgba(0,0,0,.45);
      --radius: 14px;
      --field-h: 52px;         /* big mobile tap target */
    }

    /* cinematic background */
    body{
      margin:0;
      min-height:100svh;
      color:var(--text);
      font: 400 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background:
        radial-gradient(1200px 800px at 70% -10%, rgba(42,146,255,.12), transparent 60%),
        radial-gradient(1000px 700px at -10% 20%, rgba(36,216,138,.10), transparent 60%),
        linear-gradient(180deg, #0b0f14, #070a0e 60%, #05080c);
      overflow-x:hidden;
    }

    /* subtle scanlines + noise for ‚Äúmystery‚Äù */
    body::before{
      content:"";
      position:fixed; inset:0;
      background:
        repeating-linear-gradient(transparent, transparent 2px, rgba(255,255,255,.02) 3px),
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 64 64"><filter id="n"><feTurbulence baseFrequency="0.8" numOctaves="2" stitchTiles="stitch"/></filter><rect width="64" height="64" filter="url(%23n)" opacity="0.04"/></svg>');
      pointer-events:none;
      animation: scan 9s linear infinite;
    }
    @keyframes scan { 0%{opacity:.25} 50%{opacity:.35} 100%{opacity:.25} }

    .wrap{
      max-width: 720px;
      margin: clamp(16px, 6svh, 64px) auto;
      padding: 0 16px;
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.03), transparent) , var(--panel);
      border:1px solid var(--outline);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: clamp(14px, 3.5svh, 24px);
    }

    .title{
      text-align:center;
      font-weight:800;
      letter-spacing:.5px;
      margin: 6px 0 14px;
      text-shadow: 0 0 18px rgba(42,146,255,.25);
    }

    .badge{
      display:inline-block;
      padding:6px 10px;
      border-radius:10px;
      background: rgba(42,146,255,.12);
      color:#b9d8ff;
      border:1px solid rgba(42,146,255,.25);
      font-weight:600;
    }

    .grid{
      margin-top:12px;
      display:grid;
      grid-template-columns: 1fr 1fr auto;
      gap:10px;
    }
    @media (max-width:560px){
      .grid{ grid-template-columns: 1fr 1fr; }
      .grid button{ grid-column: 1 / -1; }
    }

    select, input{
      height: var(--field-h);
      padding: 0 14px;
      border-radius: 12px;
      border:1px solid var(--outline);
      background: var(--input);
      color: var(--text);
      outline: none;
      transition: box-shadow .2s ease, border-color .2s ease, transform .04s ease;
      font-size: 16px;
      -webkit-appearance:none;
      appearance:none;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.02);
    }
    input::placeholder{ color: #7c8da0; }
    select:focus, input:focus{
      border-color: rgba(42,146,255,.65);
      box-shadow: 0 0 0 3px rgba(42,146,255,.20);
      transform: translateY(-1px);
    }
    select:disabled, input:disabled{ opacity:.6; }

    button{
      height: var(--field-h);
      padding: 0 18px;
      border:0;
      border-radius: 12px;
      background: linear-gradient(180deg, #2fdc97, #12a86b);
      color:#051013;
      font-weight:800;
      font-size:16px;
      letter-spacing:.3px;
      cursor:pointer;
      box-shadow: 0 8px 22px rgba(36,216,138,.25), 0 0 0 1px rgba(0,0,0,.25) inset;
      transition: transform .06s ease, filter .15s ease;
    }
    button:hover{ filter: brightness(1.08); }
    button:active{ transform: translateY(1px) scale(.995); }
    button[disabled]{ opacity:.55; cursor:not-allowed; filter:grayscale(.2); }

    .msg{ margin-top:10px; font-size:14px; color:var(--muted); }
    .msg.ok{ color: var(--accent); text-shadow: 0 0 12px rgba(36,216,138,.35); }
    .msg.err{ color: var(--danger); }
    .msg.warn{ color: var(--warning); }

    .row{ display:flex; align-items:center; gap:8px; flex-wrap:wrap; }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }
    .hint {
  margin: 6px 0 10px;
  font-size: 13px;
  color: #b0bec5;
  text-align: left;
}
  </style>
</head>
<body>
  <div class="wrap">
    <h1 class="title">Defuse Bomb</h1>
    <div class="card">
      <div class="row">
        <div>Bomb ID: <span id="bombId" class="mono badge"></span></div>
      </div>

      <div class="grid">
        <select id="group">
          <option value="" selected hidden>Select grp</option>
          <option>1</option><option>2</option><option>3</option><option>4</option>
          <option>5</option><option>6</option><option>7</option><option>8</option>
        </select>

        <input id="pass" type="text" placeholder="Enter Password" inputmode="text" autocomplete="off" />
        <p class="hint">Password ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç ‡∏´‡∏£‡∏∑‡∏≠ ‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>

        <button id="btn" type="button" aria-label="Defuse">Defuse</button>
      </div>

      <div id="msg" class="msg">Loading‚Ä¶</div>
    </div>
  </div>

<script>
  /* ====== CONFIG: paste your Apps Script /exec ====== */
  const API_BASE = 'https://script.google.com/macros/s/AKfycbyIMQhvL2-3aXGVBlF6Br-7KgErcnQZus1eO07KdpbP48ainM5S3Z4dPSY-iVkYCW_o/exec';
  /* ================================================== */

  // JSONP helper (bypasses CORS)
  function jsonp(path, params) {
    return new Promise((resolve, reject) => {
      const cb = 'cb_' + Math.random().toString(36).slice(2);
      const url = API_BASE + '?' + new URLSearchParams({ ...params, action: path, callback: cb }).toString();

      const s = document.createElement('script');
      window[cb] = (data) => { resolve(data); cleanup(); };
      s.onerror = () => { reject(new Error('JSONP load error')); cleanup(); };

      function cleanup(){ try{ delete window[cb]; }catch(_){ } s.remove(); }
      s.src = url;
      document.body.appendChild(s);
    });
  }

  const qs = new URLSearchParams(location.search);
  const bombId = (qs.get('id') || '').trim();

  const idEl = document.getElementById('bombId');
  const msg  = document.getElementById('msg');
  const btn  = document.getElementById('btn');
  const pass = document.getElementById('pass');
  const grp  = document.getElementById('group');

  idEl.textContent = bombId || '‚Äî';

  function setMsg(text, cls='msg'){
    msg.className = 'msg';
    if (cls) msg.classList.add(cls.replace('msg ','').trim());
    msg.textContent = text;
  }
  function setLockedUI(on){
    pass.disabled = on;
    grp.disabled = on;
    btn.disabled = on;
  }

  async function load() {
    if (!bombId) { setMsg('‚ö†Ô∏è Missing bomb ID in URL.', 'msg err'); setLockedUI(true); return; }
    setMsg('Loading‚Ä¶','msg');
    try{
      const data = await jsonp('get', { id: bombId });
      if (!data.ok) { setMsg('‚ö†Ô∏è ' + (data.message || 'Error'), 'msg err'); return; }
      if (!data.found) { setMsg('‚ùì Bomb not found.', 'msg err'); setLockedUI(true); return; }
      if (data.locked) { setLockedUI(true); setMsg('üîí Already defused by Group ' + (data.group || '‚Äî') + '.', 'msg warn'); return; }
      setLockedUI(false); setMsg('Ready.');
    }catch(e){
      setMsg('‚ö†Ô∏è Network error: ' + e.message, 'msg err');
    }
  }

  async function defuse(){
    const g = (grp.value || '').trim();
    const v = (pass.value || '').trim();
    if (!g) { setMsg('‚ö†Ô∏è Please select a group (1‚Äì8).', 'msg err'); return; }
    if (!v) { setMsg('‚ö†Ô∏è Please enter a password.', 'msg err'); return; }

    setMsg('Checking‚Ä¶','msg');
    btn.disabled = true;

    try{
      const res = await jsonp('check', { id: bombId, password: v, group: g });
      setMsg(res.message || (res.ok ? 'OK' : 'Error'), res.ok ? 'msg ok' : 'msg err');
      if (res.locked) setLockedUI(true);
      else btn.disabled = false;
      // optional haptic on iPhone
      if (navigator.vibrate) navigator.vibrate(res.ok ? 20 : [40,40,40]);
    }catch(e){
      setMsg('‚ö†Ô∏è Network error: ' + e.message, 'msg err');
      btn.disabled = false;
    }
  }

  btn.addEventListener('click', defuse);
  pass.addEventListener('keydown', e => { if (e.key === 'Enter') defuse(); });

  load();
</script>
</body>
</html>






